From: fritsch <Peter.Fruehberger@gmail.com>
Date: Mon, 14 Jan 2019 20:54:47 +0100
Subject: [PATCH] GLES yuv2rgb: avoid pow, it's slow on embedded

diff --git a/system/shaders/GLES/2.0/gles_yuv2rgb_basic.frag b/system/shaders/GLES/2.0/gles_yuv2rgb_basic.frag
index ecd82b13ca..6d0748d52f 100644
--- a/system/shaders/GLES/2.0/gles_yuv2rgb_basic.frag
+++ b/system/shaders/GLES/2.0/gles_yuv2rgb_basic.frag
@@ -41,6 +41,7 @@ void main()
 {
   vec4 rgb;
   vec4 yuv;
+  vec4 x;
 
 #if defined(XBMC_YV12) || defined(XBMC_NV12)
 
@@ -62,9 +63,10 @@ void main()
   rgb.a = m_alpha;
 
 #if defined(XBMC_COL_CONVERSION)
-  rgb.rgb = pow(max(vec3(0), rgb.rgb), vec3(m_gammaSrc));
+  x.rgb = max(vec3(0), rgb.rgb);
+  rgb.rgb = x.rgb * x.rgb * 0.000001134 - 0.0001514 * x.rgb + vec3(0.01036);
   rgb.rgb = max(vec3(0), m_primMat * rgb.rgb);
-  rgb.rgb = pow(rgb.rgb, vec3(m_gammaDstInv));
+  rgb.rgb = -0.0000005998 * rgb.rgb * rgb.rgb + 0.001363 * rgb.rgb + vec3(0.2059);
 
 #if defined(XBMC_TONE_MAPPING)
   float luma = dot(rgb.rgb, m_coefsDst);
